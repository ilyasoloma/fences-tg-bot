# Fences Telegram Bot

```  
  ______ 
 /      \
|  $$$$$$\ ______   _______    _______   ______    _______ 
| $$_  \$$/      \ |       \  /       \ /      \  /       \
| $$ \   |  $$$$$$\| $$$$$$$\|  $$$$$$$|  $$$$$$\|  $$$$$$$
| $$$$   | $$    $$| $$  | $$| $$      | $$    $$ \$$    \ 
| $$     | $$$$$$$$| $$  | $$| $$      | $$$$$$$$ _\$$$$$$\
| $$      \$$        $$  | $$ \$$       \$$              $$
 \$$       \$$$$$$$ \$$   \$$  \$$$$$$$  \$$$$$$$ \$$$$$$$ üö¨üö¨üö¨
```

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø—Ä–æ–≤–µ—Å—Ç–∏ –∑–∞–±–æ—Ä—á–∏–∫–∏ –ø—Ä—è–º–æ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª–∞–≥–µ—Ä—è, —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏—Ö –æ—Ç—Ä—è–¥–æ–≤ –∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –¥–µ—Ç–µ–π. –°—Ç–µ–∫: aiogram + MongoDB

## –ß—Ç–æ —Ç–∞–∫–æ–µ "–∑–∞–±–æ—Ä—á–∏–∫"

–ù–∞–∑–≤–∞–Ω–∏–µ "–∑–∞–±–æ—Ä—á–∏–∫" –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–æ [–ø—Ä–∏—Ç—á–µ–π –æ –≥–≤–æ–∑–¥—è—Ö](https://habr.com/ru/articles/25678/). –¢—Ä–∞–∫—Ç–æ–≤–∞—Ç—å –µ–µ –º–æ–∂–Ω–æ –ø–æ —Ä–∞–∑–Ω–æ–º—É. –î–ª—è –º–Ω–æ–≥–∏—Ö —ç—Ç–∞ –ø—Ä–∏—Ç—á–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –¥–æ–±—Ä—ã—Ö —Å–ª–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –õ–∏—á–Ω–æ –¥–ª—è –º–µ–Ω—è, —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –æ —Ç–æ–º, —á—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤—Å–µ, —á—Ç–æ —É–≥–æ–¥–Ω–æ, –Ω–æ —É–∂–µ —Å–∫–æ—Ä–æ –Ω–∞—Å—Ç–∞–Ω–µ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –ø—Ä–∏–¥–µ—Ç—Å—è –æ—Ç–≤–µ—á–∞—Ç—å.

–°—É—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è - –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞ –∫–∞–∂–¥–æ–º "–∑–∞–±–æ—Ä—á–∏–∫–µ" —á—Ç–æ —Ç–µ–ø–ª–æ–µ –∏ –ø—Ä–∏—è—Ç–Ω–æ–µ. –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ –ø–∏—à—É—Ç –Ω–∞ —á–µ–º-—Ç–æ —Ü–µ–ª–ª—é–ª–æ–∑–Ω–æ–º. –ù–æ –∂–∏–∑–Ω—å –∏–¥—ë—Ç –≤–ø–µ—Ä–µ–¥ –∏ —è –ø—Ä–µ–¥–ª–∞–≥–∞—é –≤–∞–º –ø–æ–π—Ç–∏ –≤–º–µ—Å—Ç–µ —Å –Ω–µ–π.

## –ü–æ—á–µ–º—É —Ç–µ–ª–µ–≥—Ä–∞–º–Ω—ã–µ –∑–∞–±–æ—Ä—ã –ª—É—á—à–µ —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö

–ù–µ –º–∞–ª–µ–Ω—å–∫–∏–π, —Å–∞–º —Ä–µ—à–∏—à—å. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ç—ã –∑–¥–µ—Å—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ –¥—Ä—É–≥–æ–º—É –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –Ω–æ –≤–æ—Ç –º–æ–π –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –æ—Ç–æ–∑–≤–∞—Ç—å—Å—è —É —Ç–µ–±—è:

* –≠—Ç–æ—Ç –∑–∞–±–æ—Ä —Å–æ –≤—Å–µ–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ —Ç–æ—á–Ω–æ –¥–æ–π–¥–µ—Ç –¥–æ –∫–∞–∂–¥–æ–≥–æ –∞–¥—Ä–µ—Å–∞—Ç–∞. –û–Ω –Ω–µ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è, –∏ –Ω–µ –ø—Ä–æ–ø–∞–¥–µ—Ç –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫. –í—Å—è –∏—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ —á–∞—Ç–µ, –∞ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ –ø–∞–º—è—Ç—å (–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏–∏, –∑–∞–∫–∏–Ω—É—Ç—å –≤ obsidian, zotero, notion –∏ —Ç.–ø.)
* *–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å* –∏ *–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å*. –≠—Ç–æ —Ç—Ä—É–¥–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ª—é–±—ã–º –¥—Ä—É–≥–∏–º —Å–ø–æ—Å–æ–±–æ–º. –£ —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—Ç–µ–ª –Ω–∞–ø–∏—Å–∞—Ç—å –∑–∞–±–æ—Ä—á–∏–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–Ω–æ–Ω–∏–º–Ω–æ, –ø–æ—è–≤–∏–ª–∞—Å—å —Ç–∞–∫–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å. –ò —É –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ–ª–Ω–∞—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å - –Ω–∏–∫—Ç–æ –µ–≥–æ –Ω–µ —É–≤–∏–¥–∏—Ç. –û–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥—Ä–µ—Å–∞—Ç–∞.
* –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–æ–º—É, —á—Ç–æ —Å–∞–º –ø–∏—Å–∞–ª —Ä–∞–Ω–µ–µ. –° —Ä—É–∫–æ–ø–∏—Å–Ω—ã–º –∑–∞–±–æ—Ä–æ–º —Ç–∞–∫–æ–≥–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞
* –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –±–æ—Ç–∞ –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞. –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç —Ä–µ—à–∏—Ç—å –∫—Ç–æ —Å–º–æ–∂–µ—Ç –∏–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è
* –ê–Ω–æ–Ω–∏–º–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –∑–∞–±–æ—Ä—á–∏–∫ –∞–¥—Ä–µ—Å–∞—Ç–∞ (–ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏)
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–µ–¥–ª–∞–π–Ω –Ω–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∑–∞–±–æ—Ä—á–∏–æ–≤, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–ø–∏—Å–µ–π.
* –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∞–¥–º–∏–Ω–∞ –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –±–æ—Ç–∞. –î–ª—è –ø—Ä–æ–≥—Ä–µ–≤–∞ –±—ã–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω–æ

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
   ```bash
   git clone https://github.com/ilyasoloma/fences-tg-bot.git
   cd fences-tg-bot
   ```

2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   ```bash
   cp .env.example .env
   ```

3. **–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env`**:
   –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
    - `BOT_TOKEN`: –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞.
    - `EOL_DATETIME`: –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –±–æ—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç: `–î–î.–ú–ú.–ì–ì–ì–ì_–ß–ß:–ú–ú:–°–°`).
    - `ADMIN_USERNAME`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ Telegram (–±–µ–∑ @).
    - `ADMIN_LABEL`: –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
    - `MONGO_INITDB_ROOT_USERNAME`: –∏–º—è root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è MongoDB
    - `MONGO_INITDB_ROOT_PASSWORD`: –ø–∞—Ä–æ–ª—å root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è MongoDB
    - `MONGO_HOST`: —Ö–æ—Å—Ç MongoDB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é mongodb)
    - `MONGO_PORT`: –ø–æ—Ä—Ç MongoDB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 27017)
    - `MONGO_DB_NAME`: –Ω–∞–∑–≤–∞–Ω–∏–µ –ë–î –≤ MongoDB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é fences)
    - `MONGO_DB_URL`: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –≤—ã—Ö–æ–¥ –Ω–∞ MongoDB
    - `LOG_FILE`: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ª–æ–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `./logs/bot.log`).
    - `LOG_LEVEL`: –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `INFO`, `DEBUG`, `WARNING`).

–ü—Ä–∏–º–µ—Ä `.env`:
   ```
BOT_TOKEN=<—Ç–æ–∫–µ–Ω, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –≤ BotFather>
EOL_DATETIME=12.12.2030_17:40:00

ADMIN_USERNAME=<username –≤ —Ç–µ–ª–µ–≥—Ä–∞–º>
ADMIN_LABEL='—Ü–µ–¥—Ä–∞üö¨'

MONGO_INITDB_ROOT_USERNAME=admin
MONGO_INITDB_ROOT_PASSWORD=<–ø–∞—Ä–æ–ª—å>

MONGO_HOST=mongodb
MONGO_PORT=27017
MONGO_DB_NAME=fences

LOG_FILE=./logs/bot.log
LOG_LEVEL=INFO
   ```

4. **–°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–≥–æ–≤**:
   ```bash
   mkdir -p logs
   ```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞**:
   ```bash
   docker-compose up -d
   ```

6. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞**:
    - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤ Telegram, –æ—Ç–ø—Ä–∞–≤–∏–≤ –∫–æ–º–∞–Ω–¥—É `/start`.
    - –ü—Ä–∏ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —Å –ø–æ–º–æ—â—å—é:
      ```bash
      docker-compose logs bot
      ```

7. **–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**:
   ```bash
   docker-compose stop
   ```
8. **–ó–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**
   ```bash
   docker-compose start
   ```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫
- –ü—Ä–∏ –Ω–µ–ø–æ–ª–∞–¥–∫–∞—Ö (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ) –ø–æ–≤—Ç–æ—Ä–Ω–æ —É–±–µ–¥–∏—Ç–µ—Å—å –≤ —Ç–æ–º, —á—Ç–æ —Ñ–∞–π–ª `.env` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∞ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–ª—è MongoDB –ø–æ—Ä—Ç –Ω–µ –±—ã–ª –∑–∞–Ω—è—Ç —Ä–∞–Ω–µ–µ
- –î–ª—è –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ —Å–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏ : `docker-compose logs bot` –∏ –∑–∞–≤–æ–¥–∏–º *issue*

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
* –õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å —Ñ–∏–∫—Å –Ω–∞ –∑–∞–º–µ—á–µ–Ω–Ω—ã–π –±–∞–≥ - —Å–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ
* –õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Å–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ - –∑–∞–≤–µ—Å—Ç–∏ *issue*
* –õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø–æ–ø—Ä–æ—Å–∏—Ç—å –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å - –∑–∞–≤–µ—Å—Ç–∏ *issue*
* –õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å - –ø–æ–º–æ—á—å —Å–∞–º–æ–º—É
* –õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Å–∫–∞–∑–∞—Ç—å "—Å–ø–∞—Å–∏–±–æ" - –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∑–≤–µ–∑–¥–æ—á–∫—É
–ê –¥–ª—è –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–∏—á–∫–∞üö¨